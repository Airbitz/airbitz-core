inherit lib

version="0.21.0"
source="https://github.com/libgit2/libgit2/archive/v$version.tar.gz"

build() {
    cd libgit2-$version
    export install_dir

    case $target in
    android-*) cmakeflags=-DANDROID=1 ;;
    esac

    mkdir -p build
    cd build
    cmake .. \
        -DCMAKE_TOOLCHAIN_FILE=$recipe_dir/../../classes/ios.toolchain.cmake \
        -DCMAKE_INSTALL_PREFIX=$install_dir \
        -DBUILD_SHARED_LIBS:BOOL=FALSE \
        $cmakeflags
    cmake --build . --target install
}

include="include/git2.h include/git/*"
lib="lib/libgit2.a"
